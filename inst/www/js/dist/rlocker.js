!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);
/**
 * Fast UUID generator, RFC4122 version 4 compliant.
 * @author Jeff Ward (jcward.com).
 * @license MIT license
 * @link https://jcward.com/UUID.js
 **/
var i={generate:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);var n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&s]+t[s>>8&255]+t[s>>16&255]+t[s>>24&255]}};
/**
 * rlocker - An xAPI Statement Generator & Storage Mechanism
 * @author Bob Carey (https://github.com/rpc5102).
 * @license GPL-2.0+
 **/if("undefined"==typeof ADL)throw"Error: ADL Wrapper not defined";if(void 0===i)throw"Error: UUID Generator not defined";class r{constructor(t){this.debug=!0,this.config=t||{base_url:"http://localhost:8000/xapi/",auth:"Basic "+toBase64("abcd:1234")},this.config.endpoint=(this.config.base_url+"/data/xAPI/").replace(/([^:]\/)\/+/g,"$1"),this.session={id:null,launched:null},this.agent=null,this.activity=null,this.init()}init(){ADL.XAPIWrapper.changeConfig(this.config),this.setSession(),this.setCurrentAgent("mailto:default@example.org"),this.setCurrentActivity(window.location.href,document.title),this.experienced_xAPI()}setSession(){if("undefined"!=typeof Storage){let t=sessionStorage.getItem("sid");t?this.session.launched=!1:(t=i.generate(),sessionStorage.setItem("sid",t),this.session.launched=!0),this.session.id=t}else this.session.id="0000-0000-0000-0000"}getSession(){return this.session}store(t){let e=this.debug;ADL.XAPIWrapper.sendStatement(t,function(t,n){return e&&(200!=t.status?console.error(t):console.info(n)),Shiny.onInputChange("storageStatus",t.status),n})}setCurrentAgent(t,e=this.session.id){this.agent=new ADL.XAPIStatement.Agent(ADL.XAPIWrapper.hash(t),e)}getCurrentAgent(){return this.agent}setCurrentActivity(t,e){this.activity=new ADL.XAPIStatement.Activity(t,e)}getCurrentActivity(){return this.activity}getVerb(t,e){return new ADL.XAPIStatement.Verb(t,e)}createBasicStatement(t,e="http://adlnet.gov/expapi/verbs/"+t){return new ADL.XAPIStatement(this.getCurrentAgent(),this.getVerb(e,t),this.getCurrentActivity())}createStatement(t){let e=new ADL.XAPIStatement(this.getCurrentAgent(),new ADL.XAPIStatement.Verb(t.verb),new ADL.XAPIStatement.Activity(t.object));return e.result=t.result,e}experienced_xAPI(){let t=this.session.launched?"launched":"experienced";this.store(this.createBasicStatement(t)),this.session.launched=!1}terminated_xAPI(){this.store(this.createBasicStatement("terminated"))}completed_xAPI(){this.store(this.createBasicStatement("completed"))}answered_xAPI(t,e,n,i){let r=e.attempt?e.attempt:1,s=this.activity.id+"#"+t,a=this.activity.definition.name["en-US"]+" :: "+t,o=this.getCurrentAgent(),c=this.getVerb("http://adlnet.gov/expapi/verbs/answered","answered"),u=new ADL.XAPIStatement.Activity(s,a),d=new ADL.XAPIStatement(o,c,u);return d.object.definition.type="http://adlnet.gov/expapi/activities/interaction",d.object.definition.interactionType=e.interactionType,d.object.definition.correctResponsesPattern=[JSON.stringify(e.validateOn),e.answers.toString()],d.result={success:i,response:String(n),extensions:{"http://adlnet.gov/expapi/verbs/attempted":r.toString()}},this.store(d),d}interacted_xAPI(t){let e=this.activity.id+"#"+t,n=this.activity.definition.name["en-US"]+" :: "+t,i=this.getCurrentAgent(),r=this.getVerb("http://adlnet.gov/expapi/verbs/interacted","interacted"),s=new ADL.XAPIStatement.Activity(e,n),a=new ADL.XAPIStatement(i,r,s);a.object.definition.type="http://adlnet.gov/expapi/activities/interaction",a.object.definition.interactionType="other",this.store(a)}}var s=s||{};Shiny.addCustomMessageHandler("rlocker-setup",function(t){s=new r(t)}),Shiny.addCustomMessageHandler("rlocker-store",function(t){let e=s.createStatement(t);s.store(e)}),Shiny.addCustomMessageHandler("create-statement",function(t){let e=s.createBasicStatement(t.verb.display["en-US"]);s.store(e)})}]);